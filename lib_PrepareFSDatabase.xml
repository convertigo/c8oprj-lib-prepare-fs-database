<?xml version="1.0" encoding="UTF-8"?><convertigo beans="7.4.5.m006" engine="7.4.5" studio="7.4.5" version="7.4.5 (build 43105)">
<!--<Project : lib_PrepareFSDatabase>                                                                                                                     --><project classname="com.twinsoft.convertigo.beans.core.Project" priority="0"><property name="bStrictMode"><java.lang.Boolean value="true"/></property><property name="browserDefinitions"><xmlizable classname="com.twinsoft.convertigo.beans.common.XMLVector"><com.twinsoft.convertigo.beans.common.XMLVector/></xmlizable></property><property name="comment"><java.lang.String value="This library will help by preparing an offline FullSync database to be downloaded or installed within an Mobile Application.&#13;&#10;&#13;&#10;This is usefull for preparing large offline databases that will be downloaded once and then synced for updates."/></property><property name="corsOrigin"><java.lang.String value="*"/></property><property name="httpSessionTimeout"><java.lang.Integer value="3600"/></property><property name="jsonOutput"><java.lang.String value="useType"/></property><property name="jsonRoot"><java.lang.String value="docChildNodes"/></property><property name="name"><java.lang.String value="lib_PrepareFSDatabase"/></property><property name="namespaceUri"><java.lang.String value=""/></property><property name="schemaElementForm"><java.lang.String value="unqualified"/></property><property name="schemaInline"><java.lang.Boolean value="true"/></property><property name="version"><java.lang.String value="2017.06.08"/></property><property name="wsdlStyle"><java.lang.String value="docLiteral"/></property><property name="xpathEngine"><java.lang.String value="JXPath"/></property>
<!--   <SQL connector : void>                                                                                                                             --><connector classname="com.twinsoft.convertigo.beans.connectors.SqlConnector" default="true" priority="0"><property name="billingClassName"><java.lang.String value=""/></property><property name="comment"><java.lang.String value="void connector, replace or don't use it"/></property><property name="connectionPool"><java.lang.Boolean value="true"/></property><property name="endTransactionName"><java.lang.String value=""/></property><property name="idleConnectionTestTime"><java.lang.Long value="60"/></property><property name="isTasAuthenticationRequired"><java.lang.Boolean value="false"/></property><property name="jdbcDriverClassName"><java.lang.String value="org.hsqldb.jdbcDriver"/></property><property name="jdbcMaxConnection"><java.lang.Integer value="10"/></property><property name="jdbcURL"><java.lang.String value="jdbc:hsqldb:file:.//hsqldb"/></property><property name="jdbcUserName"><java.lang.String value="SA"/></property><property ciphered="true" name="jdbcUserPassword"><java.lang.String value="xd8e180806a1c1d83a6255212121ab827"/></property><property name="keepConnectionAliveAfterTransaction"><java.lang.Boolean value="true"/></property><property name="name"><java.lang.String value="void"/></property><property name="systemTablesQuery"><java.lang.String value=""/></property><property name="testOnBorrow"><java.lang.Boolean value="false"/></property>
<!--      <SQL transaction : void>                                                                                                                        --><transaction classname="com.twinsoft.convertigo.beans.transactions.SqlTransaction" default="true" priority="0"><property name="accessibility"><java.lang.String value="Public"/></property><property name="addStatistics"><java.lang.Boolean value="false"/></property><property name="authenticatedContextRequired"><java.lang.Boolean value="false"/></property><property name="authenticatedUserAsCacheKey"><java.lang.Boolean value="false"/></property><property name="autoCommit"><java.lang.Integer value="1"/></property><property name="bIncludeCertificateGroup"><java.lang.Boolean value="false"/></property><property name="billable"><java.lang.Boolean value="false"/></property><property name="clientCachable"><java.lang.Boolean value="false"/></property><property name="comment"><java.lang.String value="does nothing"/></property><property name="encodingCharSet"><java.lang.String value="UTF-8"/></property><property name="maxResult"><java.lang.String value=""/></property><property name="name"><java.lang.String value="void"/></property><property name="orderedVariables"><xmlizable classname="com.twinsoft.convertigo.beans.common.XMLVector"><com.twinsoft.convertigo.beans.common.XMLVector><xmlizable classname="com.twinsoft.convertigo.beans.common.XMLVector"><com.twinsoft.convertigo.beans.common.XMLVector/></xmlizable></com.twinsoft.convertigo.beans.common.XMLVector></xmlizable></property><property name="responseExpiryDate"><java.lang.String value=""/></property><property name="responseTimeout"><java.lang.Long value="60"/></property><property name="secureConnectionRequired"><java.lang.Boolean value="false"/></property><property name="sheetLocation"><java.lang.Integer value="0"/></property><property name="sqlQuery"><java.lang.String value=""/></property><property name="xmlDefaultColumnTagname"><java.lang.String value="column"/></property><property name="xmlDefaultRowTagname"><java.lang.String value="row"/></property><property name="xmlGrouping"><java.lang.Boolean value="true"/></property><property name="xmlOutput"><java.lang.Integer value="0"/></property><wsdltype/><handlers><![CDATA[
// Handles the transaction start event.
function onTransactionStarted() {
    // TODO: add your code here

    // TODO: customize the returned value (if you omit returned value, the 
    // algorithm will continue its process).
    // Possible values are:
    //    cancel - means the algorithm cancels the transaction core process.

    log.message("This transaction does nothing as it has a return \"cancel\" statement in the \"onTransactionStarted\" handler.");
    
    return "cancel";
}
]]></handlers>
<!--      </SQL transaction : void>                                                                                                                       --></transaction>
<!--   </SQL connector : void>                                                                                                                            --></connector>
<!--   <Generic Sequence : PreparePrebuiltDatabase>                                                                                                       --><sequence classname="com.twinsoft.convertigo.beans.sequences.GenericSequence" handlePriorities="true" priority="0"><property name="accessibility"><java.lang.String value="Hidden"/></property><property name="addStatistics"><java.lang.Boolean value="false"/></property><property name="authenticatedContextRequired"><java.lang.Boolean value="false"/></property><property name="authenticatedUserAsCacheKey"><java.lang.Boolean value="false"/></property><property name="billable"><java.lang.Boolean value="false"/></property><property name="clientCachable"><java.lang.Boolean value="false"/></property><property name="comment"><java.lang.String value=""/></property><property name="encodingCharSet"><java.lang.String value="UTF-8"/></property><property name="includeResponseElement"><java.lang.Boolean value="true"/></property><property name="name"><java.lang.String value="PreparePrebuiltDatabase"/></property><property name="orderedSteps"><xmlizable classname="com.twinsoft.convertigo.beans.common.XMLVector"><com.twinsoft.convertigo.beans.common.XMLVector><xmlizable classname="com.twinsoft.convertigo.beans.common.XMLVector"><com.twinsoft.convertigo.beans.common.XMLVector><java.lang.Long value="1495619020825"/></com.twinsoft.convertigo.beans.common.XMLVector></xmlizable></com.twinsoft.convertigo.beans.common.XMLVector></xmlizable></property><property name="orderedVariables"><xmlizable classname="com.twinsoft.convertigo.beans.common.XMLVector"><com.twinsoft.convertigo.beans.common.XMLVector><xmlizable classname="com.twinsoft.convertigo.beans.common.XMLVector"><com.twinsoft.convertigo.beans.common.XMLVector><java.lang.Long value="1495619068729"/><java.lang.Long value="1495632316602"/></com.twinsoft.convertigo.beans.common.XMLVector></xmlizable></com.twinsoft.convertigo.beans.common.XMLVector></xmlizable></property><property name="responseExpiryDate"><java.lang.String value=""/></property><property name="responseTimeout"><java.lang.Long value="3600"/></property><property name="secureConnectionRequired"><java.lang.Boolean value="false"/></property><property name="sheetLocation"><java.lang.Integer value="0"/></property><wsdltype/>
<!--      <Sequence JS : PreparePrebuiltDatabase>                                                                                                         --><step classname="com.twinsoft.convertigo.beans.steps.SimpleStep" newPriority="1495619020825" priority="1495619020825"><property name="comment"><java.lang.String value=""/></property><property name="expression"><java.lang.String value="/**&#13;&#10;* Launch the PreparePreBuiltDatabase tool.&#13;&#10;*/&#13;&#10;function buildDatabase() {&#13;&#10;    context.addTextNodeUnderRoot(&quot;database&quot;, database);&#13;&#10;    &#13;&#10;    var jar = new java.io.File(context.getProjectDirectory() + &quot;/PreparePreBuiltDatabase.jar&quot;);&#13;&#10;    context.addTextNodeUnderRoot(&quot;jarPath&quot;, jar.getAbsolutePath());&#13;&#10;    context.addTextNodeUnderRoot(&quot;jarExists&quot;, &quot;&quot; + jar.exists());&#13;&#10;    &#13;&#10;    var requestUrl = &quot;&quot; + context.httpServletRequest.getRequestURL();&#13;&#10;    context.addTextNodeUnderRoot(&quot;requestUrl&quot;, requestUrl);&#13;&#10;    &#13;&#10;    var convertigoUrl = requestUrl.replace(new RegExp(&quot;(.*?)/projects/.*&quot;), &quot;$1&quot;);&#13;&#10;    context.addTextNodeUnderRoot(&quot;convertigoUrl&quot;, convertigoUrl);&#13;&#10;    &#13;&#10;    var privateDir = new java.io.File(context.getProjectDirectory() + &quot;/_private&quot;);&#13;&#10;    privateDir.mkdirs();&#13;&#10;    context.addTextNodeUnderRoot(&quot;privateDir&quot;, privateDir.getAbsolutePath()); &#13;&#10;    &#13;&#10;    var zipFile = new java.io.File(context.getProjectDirectory() + &quot;/&quot; + database + &quot;.zip&quot;);&#13;&#10;    destination = destination + &quot;&quot;;&#13;&#10;    &#13;&#10;    var mDestination = new RegExp(&quot;([^/]+?)/.*\.zip&quot;).exec(destination) &#13;&#10;    if (mDestination) {&#13;&#10;        if (new java.io.File(com.twinsoft.convertigo.engine.Engine.PROJECTS_PATH + &quot;/&quot; + mDestination[1]).exists()) {&#13;&#10;        &#9;zipFile = new java.io.File(com.twinsoft.convertigo.engine.Engine.PROJECTS_PATH + &quot;/&quot; + destination);&#13;&#10;        }&#13;&#10;    }&#13;&#10;    &#13;&#10;    context.addTextNodeUnderRoot(&quot;zipPath&quot;, zipFile.getAbsolutePath());&#13;&#10;    &#13;&#10;    var javaExe = new java.io.File(java.lang.System.getProperty(&quot;java.home&quot;) + &quot;/bin/java&quot;);&#13;&#10;    if (!javaExe.exists()) {&#13;&#10;    &#9;javaExe = new java.io.File(java.lang.System.getProperty(&quot;java.home&quot;) + &quot;/bin/java.exe&quot;);&#13;&#10;    }&#13;&#10;    &#13;&#10;    context.addTextNodeUnderRoot(&quot;javaExe&quot;, javaExe.getAbsolutePath());&#13;&#10;    &#13;&#10;    var process = new java.lang.ProcessBuilder(javaExe.getAbsolutePath(), &quot;-jar&quot;, jar.getAbsolutePath(), convertigoUrl, database, zipFile.getAbsolutePath())&#13;&#10;    &#9;.directory(privateDir)&#13;&#10;    &#9;.redirectErrorStream(true)&#13;&#10;    &#9;.start();&#13;&#10;    var output = org.apache.commons.io.IOUtils.toString(process.getInputStream());&#13;&#10;    context.addTextNodeUnderRoot(&quot;output&quot;, output);&#13;&#10;    &#13;&#10;    var result = process.waitFor();&#13;&#10;    context.addTextNodeUnderRoot(&quot;status&quot;, &quot;&quot; + result);&#13;&#10;    context.addTextNodeUnderRoot(&quot;DatabaseZipFile&quot;, zipFile.getAbsolutePath());&#13;&#10;    context.addTextNodeUnderRoot(&quot;DatabaseZipFileUrl&quot;, convertigoUrl + &quot;/&quot; +context.getProjectName() + &quot;/&quot; + database + &quot;.zip&quot;);&#13;&#10;    return &quot;cancel&quot;;&#13;&#10;}&#13;&#10;&#13;&#10;buildDatabase();&#13;&#10;"/></property><property name="isEnable"><java.lang.Boolean value="true"/></property><property name="name"><java.lang.String value="PreparePrebuiltDatabase"/></property><property name="output"><java.lang.Boolean value="false"/></property><property name="schemaDataType"><java.lang.String value="xsd:string"/></property><property name="xmlComplexTypeAffectation"><xmlizable classname="com.twinsoft.convertigo.beans.common.XmlQName"><schemaDefinition/></xmlizable></property><property name="xmlElementRefAffectation"><xmlizable classname="com.twinsoft.convertigo.beans.common.XmlQName"><schemaDefinition/></xmlizable></property><property name="xmlSimpleTypeAffectation"><xmlizable classname="com.twinsoft.convertigo.beans.common.XmlQName"><schemaDefinition pLocalPart="string" pNamespace="http://www.w3.org/2001/XMLSchema"/></xmlizable></property>
<!--      </Sequence JS : PreparePrebuiltDatabase>                                                                                                        --></step>
<!--      <Request single-valued variable : database>                                                                                                     --><variable classname="com.twinsoft.convertigo.beans.variables.RequestableVariable" newPriority="1495619068729" priority="1495619068729"><property name="bSoapArray"><java.lang.Boolean value="false"/></property><property name="cachedKey"><java.lang.Boolean value="true"/></property><property name="comment"><java.lang.String value="The fullsync database name you want to prepare. This has to be the same name of an existing FullSync connector"/></property><property name="description"><java.lang.String value="new variable"/></property><property name="isFileUpload"><java.lang.Boolean value="false"/></property><property name="name"><java.lang.String value="database"/></property><property name="personalizable"><java.lang.Boolean value="false"/></property><property name="required"><java.lang.Boolean value="false"/></property><property name="schemaType"><java.lang.String value="xsd:string"/></property><property isNull="true" name="value"><java.lang.String value=""/></property><property name="visibility"><java.lang.Integer value="0"/></property><property name="wsdl"><java.lang.Boolean value="true"/></property><property name="xmlTypeAffectation"><xmlizable classname="com.twinsoft.convertigo.beans.common.XmlQName"><schemaDefinition pLocalPart="string" pNamespace="http://www.w3.org/2001/XMLSchema"/></xmlizable></property>
<!--      </Request single-valued variable : database>                                                                                                    --></variable>
<!--      <Request single-valued variable : destination>                                                                                                  --><variable classname="com.twinsoft.convertigo.beans.variables.RequestableVariable" newPriority="1495632316602" priority="1495632316602"><property name="bSoapArray"><java.lang.Boolean value="false"/></property><property name="cachedKey"><java.lang.Boolean value="true"/></property><property name="comment"><java.lang.String value="(optional) The zip destination, relative to the projects folder. If the path is empty or invalid, the default destination is used."/></property><property name="description"><java.lang.String value="new variable"/></property><property name="isFileUpload"><java.lang.Boolean value="false"/></property><property name="name"><java.lang.String value="destination"/></property><property name="personalizable"><java.lang.Boolean value="false"/></property><property name="required"><java.lang.Boolean value="false"/></property><property name="schemaType"><java.lang.String value="xsd:string"/></property><property isNull="true" name="value"><java.lang.String value=""/></property><property name="visibility"><java.lang.Integer value="0"/></property><property name="wsdl"><java.lang.Boolean value="true"/></property><property name="xmlTypeAffectation"><xmlizable classname="com.twinsoft.convertigo.beans.common.XmlQName"><schemaDefinition pLocalPart="string" pNamespace="http://www.w3.org/2001/XMLSchema"/></xmlizable></property>
<!--      </Request single-valued variable : destination>                                                                                                 --></variable>
<!--   </Generic Sequence : PreparePrebuiltDatabase>                                                                                                      --></sequence>
<!--</Project : lib_PrepareFSDatabase>                                                                                                                    --></project></convertigo>